---
import themes from "../styles/themes.json";
---

<div class="themes">
  {
    themes.map((theme) => (
      <a href="#" class="theme" id={theme.name}>
        {theme.name}
      </a>
    ))
  }
</div>

<script define:vars={{ themes }}>
  const links = document.querySelectorAll(".theme");

  function switchTheme(theme) {
    const themeValue = window.matchMedia("(prefers-color-scheme: dark)").matches
      ? theme.dark
      : theme.light;

    document.documentElement.style.setProperty(
      "--primary-color",
      themeValue.primary
    );
    document.documentElement.style.setProperty(
      "--secondary-color",
      themeValue.secondary
    );
    document.documentElement.style.setProperty(
      "--background-color",
      themeValue.background
    );
    document.documentElement.style.setProperty(
      "--tertiary-color",
      themeValue.tertiary
    );

    document
      .querySelector("meta[name=theme-color]")
      .setAttribute("content", themeValue.background);

    console.log("style: theme switched to: ", theme.name);
  }

  for (const link of links) {
    const themeValue = themes.find((theme) => theme.name === link.id);

    link.addEventListener("click", (event) => {
      event.preventDefault();

      window.localStorage.setItem("theme", themeValue.name);
      switchTheme(themeValue);
    });
  }
</script>
